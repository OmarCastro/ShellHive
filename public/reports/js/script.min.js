'use strict';(function(){var k,t,n,f;document.querySelector("div.graph");document.querySelector("div.nodes");document.querySelector("svg.edges");k=null;t=function(c){var a,b,e,d;a=document.documentElement;b=0;for(e=c.length;b<e;++b)if(d=c[b],d in a.style)return d}(["transform","WebkitTransform","MozTransform"]);n=io.connect();n.on("nodePosChanged",function(c){requestAnimationFrame(function(){return k.nodes[c.id].api.moveTo(c.x,c.y)})});f=angular.module("drag",[]);f.controller("Controller",function(c){c.dataNodes=
[];c.dataEdges=[];n.on("flowData",function(a){var b,e,d;k=a;for(b in e=a.nodes)d=e[b],"maxid"!==b&&(d.edges=[],c.dataNodes.push(d));for(b in e=a.edges)d=e[b],"maxid"!==b&&c.dataEdges.push(d);c.$apply()});n.emit("graph-user","")});f.directive("component",function(c){return{scope:!0,link:function(a,b,e){var d,p,h,g,l,m,k,q,r,f,s,u,v,w,x;d=a.$parent.node;h=p=0;g=d.x;l=d.y;m=b[0];k=m.style;b.bind("pointerdown",function(a){var b;b=a.target.tagName;"INPUT"!==b&&"SELECT"!==b&&"LABEL"!==b&&(c.bind("pointermove",
q),c.bind("pointerup",s),p=a.screenX-g,h=a.screenY-l,a.preventDefault(),a.stopPropagation())});q=function(a){r(a.screenX-p,a.screenY-h);n.emit("nodePosChanged",{id:d.id,x:g,y:l})};r=function(a,b){g=a;l=b;f()};f=function(){var a,b,c,e;k[t]="translate("+g+"px, "+l+"px)";a=0;for(c=(b=d.edges).length;a<c;++a)e=b[a],e.api.updateEdge()};s=function(){c.unbind("pointermove",q);c.unbind("pointerup",s);return c};a=m.getBoundingClientRect();m.style.minWidth=a.width+"px";b=m.querySelector("div.input .box").getBoundingClientRect();
e=m.querySelector("div.output .box").getBoundingClientRect();u=b.left+b.width/2-a.left;v=b.top+b.height/2-a.top;w=e.left+e.width/2-a.left;x=e.top+e.height/2-a.top;d.api={inputPos:function(){return{x:g+u,y:l+v}},outputPos:function(){return{x:g+w,y:l+x}},pos:function(){return{x:g,y:l}},size:{width:a.width,height:a.height},getbbox:function(){return m.firstChild.getBoundingClientRect()},moveTo:r};f()},restrict:"C"}});f.directive("connector",function(c){return{scope:!0,link:function(a,b,c){var d,f,h,g;
a=a.$parent.edge;d=k.nodes[a.start];f=k.nodes[a.end];d.edges.push(a);f.edges.push(a);h=b[0];g=function(a,b,c,d){var e;e=(c-a)/4;return h.setAttribute("d","M "+a+" "+b+" C "+(a+e)+","+b+" "+(a+3*e)+","+d+" "+c+","+d)};b=function(){var a,b;a=d.api.outputPos();b=f.api.inputPos();return g(a.x,a.y,b.x,b.y)};a.api={updateEdge:b};h.addEventListener("pointerdown",function(){h.classList.toggle("sel");h.classList.contains("sel")&&n.emit("run-app",{id:1})});b()}}})}).call(this);
