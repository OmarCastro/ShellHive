<div component ng-repeat="data in visualData.components track by data.id" ng-switch on='data.type' data-node-id="{{data.id}}" ng-style="{transform:transform, WebkitTransform:transform, MsTransform:transform}" class="{{data.type}}-component component">
  <div ng-switch-when="file">
    <div title="{{data.macro.description}}" class="title">
      FILE
      <a ng-click="$emit('removeComponent', data.id)" class="close-button glyphicon glyphicon-remove"></a>
    </div>
    <div class="ports">
      <div class="input">
        <span data-port="input" class="box"></span>
        <span class="text">&nbsp;overwrite&nbsp;&nbsp;</span>
        <br>
        <span data-port="append" class="box"></span>
        <span class="text">&nbsp;append&nbsp;&nbsp;</span>
      </div>
      <div style="text-align: right" class="output">
        <span class="text">&nbsp;&nbsp;content&nbsp;</span>
        <span data-port="output" class="box"></span>
      </div>
    </div>
    <br><br><br>
    <input class="filename" type="text" ng-model="data.filename">
  </div>
  
  
  
  <div ng-switch-when="subgraph">
    <div title="{{data.macro.description}}" class="title">
      <span ng-bind="data.macro.name"></span>
      <a ng-click="$emit('removeComponent', data.id)" class="close-button glyphicon glyphicon-remove"></a>
    </div>
    <div class="ports">
      <div class="input">
        <span data-port="input" class="box"></span>
        <span class="text">&nbsp;stdin&nbsp;&nbsp;</span>
      </div>
      <div style="text-align: right" class="output">
        <span class="text">&nbsp;&nbsp;stdout&nbsp;</span>
        <span data-port="output" class="box"></span><br>
        <span class="text">&nbsp;&nbsp;stderr&nbsp;</span>
        <span data-port="error" class="box"></span><br>
        <span class="text">&nbsp;&nbsp;return&nbsp;</span>
        <span data-port="retcode" class="box"></span></div>
    </div><br><br><br>
    <div>{{data.macro.description}}</div>
    <button ng-click="graph.setGraphView(data.macro)">view macro</button>
  </div>
  
  
  
  
  
  <div ng-switch-when="command">
    <div class="title"><span ng-bind="data.exec"></span>
      <a ng-click="$emit('removeComponent', data.id)" class="close-button glyphicon glyphicon-remove"></a>
    </div>
    <div class="ports">
      <div class="input"><span data-port="input" class="box"></span><span class="text">&nbsp;stdin&nbsp;&nbsp;</span></div>
      <div style="text-align: right" class="output"><span class="text">&nbsp;&nbsp;stdout&nbsp;</span><span data-port="output" class="box"></span><br><span class="text">&nbsp;&nbsp;stderr&nbsp;</span><span data-port="error" class="box"></span><br><span class="text">&nbsp;&nbsp;return&nbsp;</span><span data-port="retcode" class="box"></span></div>
    </div><br><br><br>
    
    
    
    <div ng-if="data.files !== undefined">files :<br ng-if="data.files.length > 0">
      <div ng-repeat="file in data.files track by $index"><span data-port="file{{$index}}" class="box"></span>
        <input type="text" ng-model="data.files[$index]" ng-if="isString(data.files[$index])">
        <span ng-bind-template="{{' '+data.files[$index][0]+' '}}" ng-if="isArray(data.files[$index])"></span>
        <button ng-click="data.files.splice($index,1)" class="btn btn-xs btn-default">
          <span class="glyphicon glyphicon-remove"></span>
        </button>
        <button ng-click="swapPrevious(data.files,$index,data.id)" ng-if="$index" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-chevron-up"></span></button>
        <button ng-click="swapPrevious(data.files,$index + 1,data.id)" ng-if="$index != data.files.length -1 " class="btn btn-xs btn-default"><span class="glyphicon glyphicon-chevron-down">      </span></button><br>
      </div>
      <button ng-click="data.files.push('')" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-plus"></span></button><br>
    </div>
    <div ng-if="data.exec == 'awk'">script:<br>
      <textarea type="text" ng-model="data.script"></textarea>
    </div>
    
    
    <div ng-if="data.parameters">
      <div ng-repeat="(name, option) in data.parameters track by name">
        <div class="input-group input-group-sm"><span ng-bind="name" class="input-group-addon"></span>
          <input type="text" ng-model="data.parameters[name]" class="form-control">
        </div>
      </div>
    </div>
    
    
    <div ng-if="data.exec == 'grep'">
      <div>
        <label>pattern:
          <input type="text" ng-model="data.pattern">
        </label><br>
      </div>
    </div>
    <div ng-if="isImplemented(data) &amp;&amp; data.selectors">
      <form name="myForm" ng-repeat="(name, option) in data.selectors track by name">
        <div ng-class="{'has-error': myForm.field.$invalid}" class="input-group input-group-sm">
          <label ng-bind="name" class="input-group-addon"></label>
          <input type="number" name="field" ng-model="data.selectors[name].value" 
                 ng-if="data.selectors[name].type == 'numeric parameter'" min="0" required class="form-control">
          <div class="input-group-btn">
            <button elscope type="button" ng-click="graph.setSelection({data:data, name:name},scopedElement)" class="btn btn-default">
              <span ng-bind="data.selectors[name].name"></span>&nbsp;<span class="caret"></span>
            </button>
          </div>
          <input type="text" ng-model="data.selectors[name].value" name="field" 
                 ng-if="data.selectors[name].type == 'parameter'" class="form-control">
        </div>
      </form>
    </div>
    <div>
      <span ng-repeat="(name, val) in data.flags track by name" ng-click="data.flags[name] = !val;$emit('updateComponent',data)">
        <label ng-class="(val)?'glyphicon-check':'glyphicon-unchecked'" class="glyphicon">&nbsp;</label>
        <label ng-bind="name"></label>
        <br>
      </span>
    </div>
  </div>
</div>